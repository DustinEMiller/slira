!function(){function config($routeProvider,$locationProvider){$routeProvider.when("/",{templateUrl:"../client/js/index/index.view.html",controller:"indexCtrl"}).when("/register/:registrationToken",{templateUrl:"../client/js/auth/register/register.view.html",controller:"registerCtrl"}).when("/login",{templateUrl:"../client/js/auth/login/login.view.html",controller:"loginCtrl"}).when("/account",{templateUrl:"../client/js/account/account.view.html",controller:"accountCtrl"}).otherwise({redirectTo:"/"}),$locationProvider.html5Mode(!0)}function run($rootScope,$location,$templateCache,authentication){$rootScope.$on("$routeChangeStart",function(event,nextRoute,currentRoute){console.log($location.path()),console.log(!authentication.isLoggedIn()),"/account"!==$location.path()||authentication.isLoggedIn()||$location.path("/")})}angular.module("slira",["ngRoute","templates-dist","ngMessages"]),angular.module("slira").config(["$routeProvider","$locationProvider",config]).run(["$rootScope","$location","$templateCache","authentication",run])}(),function(){function accountCtrl($location,sliraData){var sl=this;sl.user={},sliraData.getProfile().success(function(data){sl.user=data}).error(function(e){console.log(e)})}angular.module("slira").controller("accountCtrl",accountCtrl),accountCtrl.$inject=["$location","sliraData"]}(),function(){function loginCtrl($location,authentication){var sl=this;sl.credentials={email:"",password:""},sl.onSubmit=function(){authentication.login(sl.credentials).then(function(){$location.path("account")}).catch(function(err){alert(err)})}}angular.module("slira").controller("loginCtrl",loginCtrl),loginCtrl.$inject=["$location","authentication"]}(),function(){function registerCtrl($location,authentication,$routeParams,$scope){$scope.message="",$scope.invalidToken=!1,$scope.invalidRegistration=!1,$scope.credentials={email:"",password:"",token:$routeParams.registrationToken},authentication.registrationToken($routeParams.registrationToken).then(function(response){response.data.success?$scope.credentials.email=response.data.email:($scope.registration.$error.formLevel=!0,$scope.invalidToken=!0,$scope.message=response.data.msg)}).catch(function(err){$scope.registration.$error.formLevel=!0,$scope.invalidToken=!0,$scope.message="Internal error. Please try again"}),$scope.onSubmit=function(isValid){isValid&&authentication.register($scope.credentials).then(function(response){response.data.success?$location.path("account"):($scope.invalidRegistration=!0,$scope.registrationMessage=response.data.msg)}).catch(function(err){'child "password" fails because ["password" is not allowed to be empty]'==err.data.message?$scope.registrationMessage="Password must not be empty":'child "password" fails because ["password" length must be at least 6 characters long]'==err.data.message?$scope.message="Password must be at least 6 characters longs":'child "email" fails because ["email" is not allowed to be empty]'==err.data.registrationMessage?$scope.registrationMessage="Email must not be empty":$scope.registrationMessage="There was an error. Please try again."})}}angular.module("slira").controller("registerCtrl",registerCtrl),registerCtrl.$inject=["$location","authentication","$routeParams","$scope"]}(),function(){function authentication($http,$window){var saveToken=function(token){$window.localStorage["slira-token"]=token},getToken=function(){return $window.localStorage["slira-token"]},isLoggedIn=function(){var payload,token=getToken();return!!token&&(payload=token.split(".")[1],payload=$window.atob(payload),payload=JSON.parse(payload),payload.exp>Date.now()/1e3)},currentUser=function(){if(isLoggedIn()){var token=getToken(),payload=token.split(".")[1];return payload=$window.atob(payload),payload=JSON.parse(payload),{email:payload.email,name:payload.name}}},registrationToken=function(registrationToken){return console.log(registrationToken),$http.post("/api/user/registrationRequest",{token:registrationToken}).then(function(request){return request}).catch(function(data){return data})},register=function(user){return $http.post("/api/user/create",user).then(function(data){return data.success&&saveToken(data.token),data})},login=function(user){return $http.post("/api/user/authenticate",user).then(function(data){saveToken(data.token)})},logout=function(){$window.localStorage.removeItem("slira-token")};return{currentUser:currentUser,saveToken:saveToken,getToken:getToken,isLoggedIn:isLoggedIn,register:register,registrationToken:registrationToken,login:login,logout:logout}}angular.module("slira").service("authentication",authentication),authentication.$inject=["$http","$window"]}(),function(){function sliraData($http,authentication){var getProfile=function(){return $http.get("/api/user/information",{headers:{Authorization:"Bearer "+authentication.getToken()}})};return{getProfile:getProfile}}angular.module("slira").service("sliraData",sliraData),sliraData.$inject=["$http","authentication"]}(),function($templateCache){function indexCtrl(){}angular.module("slira").controller("indexCtrl",indexCtrl)}(),angular.module("templates-dist",["../client/js/account/account.view.html","../client/js/auth/login/login.view.html","../client/js/auth/register/register.view.html","../client/js/index/index.view.html"]),angular.module("../client/js/account/account.view.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../client/js/account/account.view.html",'<navigation></navigation>\n\n<div class="container">\n    <div class="row">\n        <div class="col-md-6">\n            <h1 class="form-signin-heading">Your profile</h1>\n            <form  class="form-horizontal">\n                <div class="form-group">\n                    <label class="col-sm-3 control-label">Full name</label>\n                    <p class="form-control-static">{{ vm.user.name }}</p>\n                </div>\n                <div class="form-group">\n                    <label class="col-sm-3 control-label">Email</label>\n                    <p class="form-control-static">{{ vm.user.email }}</p>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>')}]),angular.module("../client/js/auth/login/login.view.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../client/js/auth/login/login.view.html",'<navigation></navigation>\n\n<div class="container">\n\n  <div class="row">\n\n    <div class="col-md-6">\n\n      <h1 class="form-signin-heading">Sign in</h1>\n      <p class="lead">Not a member? Please <a href="register">register</a> instead.</p>\n\n        <form ng-submit="sl.onSubmit()">\n            <div class="form-group">\n                <label for="email">Email address</label>\n                <input type="email" class="form-control" id="email" placeholder="Enter email" ng-model="sl.credentials.email">\n            </div>\n            <div class="form-group">\n                <label for="password">Password</label>\n                <input type="password" class="form-control" id="password" placeholder="Password" ng-model="sl.credentials.password">\n            </div>\n            <button type="submit" class="btn btn-default">Sign in!</button>\n        </form>\n\n    </div>\n</div>\n\n</div>')}]),angular.module("../client/js/auth/register/register.view.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../client/js/auth/register/register.view.html",'<navigation></navigation>\n\n<div class="container">\n<div class="row">\n    <div class="col-md-6">\n        <h1>Register</h1>\n        <p class="lead">If you already have an account, please <a href="login">log in</a> instead.</p>\n        <form name="registration" ng-submit="onSubmit(registration.$valid)" novalidate>\n            <div ng-show="invalidToken">\n                <div class="alert alert-danger">{{message}}</div>\n            </div>\n            <div ng-show="invalidRegistration">\n                <div class="alert alert-danger">{{registrationMessage}}</div>\n            </div>\n\n            <div class="form-group">\n                <label for="email">Email address</label>\n                <input type="email" class="form-control" id="email" placeholder="Enter email" name=\'email\' ng-model="credentials.email" ng-disabled="invalidToken" required>\n                <div ng-messages="registration.email.$error" ng-hide="invalidToken">\n                    <div ng-message="required">Email is required.</div>\n                    <div ng-message="email">Your email address is invalid</div>\n                </div>\n            </div>\n            <div class="form-group">\n                <label for="password">Password</label>\n                <input type="password" class="form-control" id="password" placeholder="Password" name="password" ng-model="credentials.password" ng-disabled="invalidToken" ng-minlength="6" required>\n                <div ng-messages="registration.password.$error" ng-hide="invalidToken">\n                    <div ng-message="required">Password is required.</div>\n                    <div ng-message="minlength">Password must be at least 6 characters long.</div>\n                </div>\n            </div>\n            <button type="submit" class="btn btn-default" ng-disabled="!registration.$valid || invalidToken">Register</button>\n        </form>\n    </div>\n</div>\n</div>')}]),angular.module("../client/js/index/index.view.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../client/js/index/index.view.html",'<navigation></navigation>\n<div class="container">\n\t<h1>Greetings</h1>\n\t<p>Please <a href="login">sign in</a> or <a href="register">register</a></p>\n</div>')}]);